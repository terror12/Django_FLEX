$(document).ready(function(){renderTeamsDropdown();$.ajax({url:"/data/slates/recent/"+window.sport+"/"+window.platform+"?date="+window.url_start_date+"&slate="+window.slate,success:function(a){for(var d="",b=0;b<a.dates.length;b++)var c=$("#projections-date-template").html(),f=window.url_start_date==a.dates[b].start_date?"border-bottom-2 border-green-lt ":"border-bottom-2 border-invisible ",e="/"+window.sport+"/projections/"+window.platform+"/"+a.dates[b].start_date+"/",c=c.replace(/{short_dow_name}/g,
a.dates[b].short_dow_name),c=c.replace(/{month_daynum}/g,a.dates[b].month_daynum),c=c.replace(/{url}/g,e.toLowerCase()),c=c.replace(/{custom_css}/g,f),d=d+c;if(a.curr_slate)var g=$("#projections-current-slate-template").html(),g=g.replace(/{short_dow_name}/g,a.curr_slate.short_dow_name),g=g.replace(/{start_hhmm}/g,a.curr_slate.start_hhmm),g=g.replace(/{team_count}/g,a.curr_slate.team_count);else g=$("#projections-current-slate-error-template").html();if(a.slates)for(var h="",b=0;b<a.slates.length;b++)c=
$("#projections-all-slates-template").html(),c=c.replace(/{short_dow_name}/g,a.slates[b].short_dow_name),c=c.replace(/{start_hhmm}/g,a.slates[b].start_hhmm),c=c.replace(/{team_count}/g,a.slates[b].team_count),c=c.replace(/{slate_type}/g,a.slates[b].slate_type),c=c.replace(/{platform}/g,window.platform),c=c.replace(/{sport}/g,window.sport.toLowerCase()),c=c.replace(/{start_date}/g,window.url_start_date),h+=c;setTimeout(function(){$("#projections-dates-target").empty().html(d);$("#projections-curr-slate-target").empty().html(g);
$("#projections-all-slates-target").empty().html(h)},400)}})});$(document).on("click","#projections #projections-positions-trigger",function(a){$("#projections-filter-position").toggleClass("active")});$(document).on("click",".projections-filter-players",function(a){$("#filterWindow").removeClass("hidden");$("#filterWindow").addClass("open");$("body").addClass("noscroll bg-black-dk");$(".ui-page-active").addClass("blur")});$(document).on("click","#projections-show-more",function(a){showMorePlayers()});
$(document).on("click",".dynamic-popup-close, div.ui-page-active.blur",function(a){$("#filterWindow").removeClass("open");$("body").removeClass("noscroll bg-black-dk");$(".ui-page-active").removeClass("blur");$("#filterWindow").addClass("hidden")});1==window.valid&&initProjSliders();
$(document).on("click","#projections .position-filter-item",function(a){$(this).addClass("active");$(this).siblings().removeClass("active");a=$(this).data("position");window.filters.position_code=a;a="ALL"==a?"Positions":a;$("div.ui-page-active .projections-filter-position-label span").text(a);filterProjections()});
$(document).on("click","input[data-toggle=injury]",function(){var a=$(this).data("value"),d=window.filters.injuries.indexOf(a);1==$(this).prop("checked")&&-1==d?window.filters.injuries.push(a):-1!==d&&window.filters.injuries.splice(d,1);filterProjections()});$(document).on("click",".projections-slates-trigger",function(a){$(this).toggleClass("open");$(this).hasClass("open")?$(".projections-slates-container").addClass("open"):$(".projections-slates-container").removeClass("open")});
$(document).on("click",".projections-filter-team-item",function(a){a=$(this).data("team");window.filters.team_code=a;a=$(this).data("label");$("div.ui-page-active .projections-filter-team-label span").text(a);filterProjections()});
$(document).on("click",".generic-filter-trigger",function(a){a.stopPropagation();$("#projections-filter-search").removeClass("active");$("#projections-filter-position").removeClass("active");$(document).off("click",genericFilterCloser);a=$(this).siblings(".generic-filter-dropdown");a.hasClass("open")?(a.removeClass("open"),$(this).removeClass("open")):($(this).addClass("open"),a.addClass("open"),$("div.ui-page-active .generic-filter-dropdown").not(a).removeClass("open"),$("div.ui-page-active .generic-filter-trigger").not($(this)).removeClass("open"),
$(document).on("click",genericFilterCloser))});$(document).on("click",".generic-filter-trigger a",function(a){a.stopPropagation()});$(document).on("change","#sort-input",function(a){a=JSON.parse($(this).val());sortTable(a.key,a.type,a.reverse)});
$(document).on("click","thead th[data-sort]",function(a){a="data-"+$(this).data("sort");var d=$(this).data("reverse"),b=$(this).data("type");sortTable(a,b,d);$("thead th[data-sort]").removeClass("active");$(this).addClass("active");a=0==d?1:0;$(this).data("reverse",a);$(this).attr("data-reverse",a)});
$(document).on("click",".projections-download",function(a){var d=[];$("div.ui-page-active .projections-listing").each(function(a,c){var b=[];b.push($(this).attr("data-fn"));b.push($(this).attr("data-ln"));b.push($(this).attr("data-pos"));b.push($(this).attr("data-inj"));"NHL"==window.sport&&(b.push($(this).attr("data-reg_line")),b.push($(this).attr("data-pp_line")),b.push($(this).attr("data-starter_flag").toString().replace("0","").replace("1","YES")));b.push($(this).attr("data-start_date"));b.push(window.slate);
b.push($(this).attr("data-team"));b.push($(this).attr("data-opp"));b.push($(this).attr("data-spread"));b.push($(this).attr("data-ou"));b.push($(this).attr("data-proj_score"));b.push($(this).attr("data-salary"));b.push($(this).attr("data-opp_rank"));b.push($(this).attr("data-ppg_min"));b.push($(this).attr("data-ppg_avg"));b.push($(this).attr("data-ppg_max"));b.push($(this).attr("data-ppg_proj"));b.push($(this).attr("data-value_proj"));d.push(b)});var b="NHL"==window.sport?"first_name,last_name,position,injury_status,reg_line,pp_line,starting_goalie,game_date,slate,team,opp,spread,over_under,implied_team_score,salary,L5_dvp_rank,L5_ppg_floor,L5_ppg_avg,L5_ppg_max,ppg_projection,value_projection,ppg_actual,value_actual\n":
"first_name,last_name,position,injury_status,game_date,slate,team,opp,spread,over_under,implied_team_score,salary,L5_dvp_rank,L5_ppg_floor,L5_ppg_avg,L5_ppg_max,ppg_projection,value_projection,ppg_actual,value_actual\n";d.forEach(function(a){b+=a.join(",");b+="\n"});var c=new Blob([b],{type:"text/csv;charset=utf-8;"});a="DFF_"+window.sport+"_cheatsheet_"+window.url_start_date+".csv";navigator.msSaveBlob?navigator.msSaveBlob(c,a):(c=document.createElement("a"),document.body.appendChild(c),c.href="data:text/csv;charset=utf-8,"+
encodeURI(b),c.target="_blank",c.download=a,c.click())});
function initProjSliders(){var a={min:0,max:window.max_ppg};$("#slider-ppg").noUiSlider({connect:!0,behaviour:"none",range:a,start:[a.min,a.max]});$("#slider-ppg").Link("lower").to($(".ppg_min"),"html",wNumb({decimals:0}));$("#slider-ppg").Link("upper").to($(".ppg_max"),"html",wNumb({decimals:0}));$("#slider-ppg").Link("lower").to($("#ppg_filter_min_rate"));$("#slider-ppg").Link("upper").to($("#ppg_filter_max_rate"));$("#slider-salary").noUiSlider({behaviour:"none",step:100,connect:!0,range:{min:2E3,
max:window.max_salary},start:[2E3,window.max_salary]});$("#slider-salary").Link("lower").to($(".salary_min"),"html",wNumb({decimals:0,postfix:"",prefix:"$",thousand:","}));$("#slider-salary").Link("upper").to($(".salary_max"),"html",wNumb({decimals:0,postfix:"",prefix:"$",thousand:","}));$("#slider-salary").Link("lower").to($("#salary_filter_min_rate"));$("#slider-salary").Link("upper").to($("#salary_filter_max_rate"));$("#slider-value").noUiSlider({behaviour:"none",step:.25,range:{min:0,max:window.max_value},
start:0});$("#slider-value").Link("lower").to($(".value_min"),"html",wNumb({decimals:1,postfix:""}));$("#slider-value").Link("lower").to($("#value_filter_min_rate"));a={nba:30,nhl:31,mlb:30,nfl:32};$("#slider-opp-rank").noUiSlider({connect:!0,behaviour:"none",range:{min:1,max:a[sport.toLowerCase()]},step:1,start:[1,a[sport.toLowerCase()]]});$("#slider-opp-rank").Link("lower").to($(".opp_rank_min"),"html",wNumb({decimals:0,postfix:""}));$("#slider-opp-rank").Link("upper").to($(".opp_rank_max"),"html",
wNumb({decimals:0,postfix:""}));$("#slider-opp-rank").Link("lower").to($("#opp_rank_filter_min_rate"));$("#slider-opp-rank").Link("upper").to($("#opp_rank_filter_max_rate"));$(".noUi-target").on("change",function(){filterProjections()})}function showMorePlayers(){$("table[data-preview='true']").attr("data-preview","false").data("preview","false")}
function genericFilterCloser(a){$("div.ui-page-active .generic-filter-dropdown").removeClass("open");$("div.ui-page-active .generic-filter-trigger").removeClass("open");$(document).off("click",genericFilterCloser)}
function filterProjections(){showMorePlayers();var a=$("#filterWindow #salary_filter_min_rate").val(),d=$("#filterWindow #salary_filter_max_rate").val(),b=$("#filterWindow #ppg_filter_min_rate").val(),c=$("#filterWindow #ppg_filter_max_rate").val(),c=$("#filterWindow #ppg_filter_max_rate").val(),f=$("#filterWindow #value_filter_min_rate").val(),e=$("#filterWindow #opp_rank_filter_min_rate").val(),g=$("#filterWindow #opp_rank_filter_max_rate").val();$("div.ui-page-active tr.projections-listing").each(function(h){$(this).data("pos")==
window.filters.position_code||"ALL"==window.filters.position_code||"FLX"==window.filters.position_code&&0<=["TE","WR","RB"].indexOf($(this).data("pos"))?$(this).data("team")==window.filters.team_code||"ALL"==window.filters.team_code?parseFloat($(this).data("salary"))>=a&&parseFloat($(this).data("salary"))<=d&&$(this).data("opp_rank")>=e&&$(this).data("opp_rank")<=g&&window.filters.injuries.includes($(this).data("inj"))?parseFloat($(this).data("ppg_proj"))>=b&&parseFloat($(this).data("ppg_proj"))<=
c&&parseFloat($(this).data("value_proj"))>=f?0<window.filters.name.length&&-1!=$(this).data("name").toLowerCase().indexOf(window.filters.name)?$(this).removeClass("hidden"):0==window.filters.name.length?$(this).removeClass("hidden"):$(this).addClass("hidden"):$(this).addClass("hidden"):$(this).addClass("hidden"):$(this).addClass("hidden"):$(this).addClass("hidden")});var h=$("table tbody tr").not(".hidden").length;$("#filter-counts").text(h)}
function renderTeamsDropdown(){for(var a={},d=document.querySelectorAll("tr.projections-listing"),b=0;b<d.length;b++){var c=d[b].getAttribute("data-team"),f=d[b].getAttribute("data-opp"),e=d[b].getAttribute("data-loc").replace("vs","v");a[c]={team:c,opp:f,location:e}}d=Object.keys(a);d.sort();c="";for(b=0;b<d.length;b++)k=d[b],f=$("#projections-filter-team-template").html(),f=f.replace(/{team}/g,a[k].team),f=f.replace(/{opp}/g,a[k].opp),f=f.replace(/{location}/g,a[k].location),c+=f;$("div.ui-page-active .projections-filter-team-target").replaceWith(c)}
function sortTable(a,d,b){showMorePlayers();var c=$("#projections tbody");c.find(".projections-listing").sort(function(c,e){if("int"==d){if(0==+$(c).attr(a).length)return 1;if(0==+$(e).attr(a).length)return-1;if(+$(c).attr(a)===+$(e).attr(a))return 0;if(0==b)return+$(c).attr(a)<+$(e).attr(a)?-1:1;if(1==b)return+$(c).attr(a)<+$(e).attr(a)?1:-1}else{if(0==$(c).attr(a).length)return 1;if(0==$(e).attr(a).length)return-1;if($(c).attr(a)===$(e).attr(a))return 0;if(0==b)return $(c).attr(a)<$(e).attr(a)?
-1:1;if(1==b)return $(c).attr(a)<$(e).attr(a)?1:-1}}).appendTo(c)};
